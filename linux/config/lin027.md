## Linux/C: 修改core文件相关配置——文件名、保存路径和文件名格式

### 1.配置步骤：

* **Step 1**: 设置core文件允许大小上限

可以用`ulimit -c`查看当前设置值，注意`0`表示不打印core文件，大于0的整数表示core文件最大允许的block数。（但是每个block是多大并未查到资料），`unlimited`表示无大小限制。

 ```shell
 $ ulimit -c unlimited
 ``` 
 
 * **Step 2**: 设置core文件路径和文件名格式
 
 可以用`cat /proc/sys/kernel/core_pattern`查看当前保存路径和文件名格式。
 
 ```shell
 # 产生的文件名为core-命令名-pid-时间戳
 $ sudo bash -c 'echo "core-%e-%p-%t" > /proc/sys/kernel/core_pattern'
 ```
 
**注意**：不能直接`sudo echo "core-%e-%p-%t" > /proc/sys/kernel/core_pattern`，也不能使用`sudo vim`修改该文件内容，否则都会报权限不足的错误。

### 2.core文件相关配置的进一步说明

某些Linux系统默认将core文件保存在当前目录（Suse Linux），有的系统则默认为系统目录（Ubuntu）。虽然可以通过配置将core文件同一记录在某个指定目录下，但个人以为还是打印在程序执行的当前目录好些。

/proc/sys/kernel/core_pattern的可选参数列表:

    `%p` - insert pid into filename 添加pid
    `%u` - insert current uid into filename 添加当前uid
    `%g` - insert current gid into filename 添加当前gid
    `%s` - insert signal that caused the coredump into the filename 添加导致产生core的信号
    `%t` - insert UNIX time that the coredump occurred into filename 添加core文件生成时的unix时间
    `%h` - insert hostname where the coredump happened into filename 添加主机名
    `%e` - insert coredumping executable name into filename 添加命令名
