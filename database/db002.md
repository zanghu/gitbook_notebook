## 数据库自增主键

[腾讯云：为什么要用自增主键？](https://cloud.tencent.com/developer/article/1462758)
[知乎：使用自增主键是否总是最佳实践？](https://www.zhihu.com/question/27603761)
[cnblogs: 杂谈自增主键用完了怎么办](https://www.cnblogs.com/rjzheng/p/10669043.html)
[廖雪峰：SQL教程](https://www.liaoxuefeng.com/wiki/1177760294764384/1218728391867808)


阅读项目的数据库设计代码时，发现某个表的某主键的说明是：自增主键



### 1.概念

作为主键最好是完全业务无关的字段，我们一般把这个字段命名为id。常见的可作为id字段的类型有：

自增整数类型：数据库会在插入数据时自动为每一条记录分配一个自增整数，这样我们就完全不用担心主键重复，也不用自己预先生成主键；

全局唯一GUID类型：使用一种全局唯一的字符串作为主键，类似8f55d96b-8acc-4636-8cb8-76bf8abc2f57。GUID算法通过网卡MAC地址、时间戳和随机数保证任意计算机在任意时间生成的字符串都是不同的，大部分编程语言都内置了GUID算法，可以自己预算出主键。

对于大部分应用来说，通常自增类型的主键就能满足需求。我们在students表中定义的主键也是BIGINT NOT NULL AUTO_INCREMENT类型。

### 2.应用举例

笔者遇到的场景为：维护商业账号的资质相关信息。账号是由全局唯一且自增的分布式ID生成器生成的，很显然这个时候我们把账号作为主键这就天然合理。于是，初版建表的时候就有了如下表结构:

```
accountId // 主键, 账号ID,全局唯一
cert // 该账号的资质
review_detail // 该账号的审核详情
cert_photo // 资质的图片
```

### 3.自增主键是不是可以认为是最佳实践

引用知乎网巢鹏友的回答：[https://www.zhihu.com/question/27603761](https://www.zhihu.com/question/27603761)

答案：不是，原因如下

1.为何要使用业务无关的值做主键

首先题主业务A, B, C组合唯一，这个东西是否具有不变性，ABC都是不变的值，也不会消失。就算是是否能保证业务以后也不会变更，这应该说谁都不能保证。所以一般不会使用这种与业务相关的组合去做主键，以避免日后的重建。

2.自增主键的优劣

优点：自增主键保证了，插入数据的主键永远比已有的数据的主键大。（看不懂就去复习数据结构）

缺点：需要等待插入完成才有主键，或者等待主键生成器返回才会有主键。不利于分布式的设计。

3.UUID的优劣势

 蘑菇叔提到的UUID的优缺点刚好和自增主键是相反的。UUID适合分布式的设计但是却少了顺序插入的保证。