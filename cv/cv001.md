# NMS原理

**1.理论基础**

说实话，讲理论基础实在不是我的强项，但是还是得硬着头皮来讲，希望我的讲解不至于晦涩难懂。  
非极大值抑制，简称为NMS算法。是一种获取局部最大值的有效方法。在3领域中，假设一个行向量的长度为w，从左向右，由第一个到第w个和其3领域中的数值进行比对。
如果某个i大于i+1并且小于i-1，则其为一个绝不最大值，同时也就意味着i+1不是一个局部最大值，所以将i移动2个步长，从i+2开始继续向后进行比较判断。如果某个i不满足上述条件，则将i+1，继续对i+1进行比对。当比对到最后一个w时，直接将w设置为局部最大值。算法流程如下图所示


**2.应用范围**

非极大值抑制NMS在目标检测，定位等领域是一种被广泛使用的方法。对于目标具体位置定位过程，不管是使用sw\(sliding Window\)还是ss\(selective search\)方法，都会产生好多的候选区域。实际看到的情形就是好多区域的交叉重叠，难以满足实际的应用。如下图所示。


针对该问题有3种传统的解决思路。  
第一种，选取好多矩形框的交集，即公共区域作为最后的目标区域。  
第二种，选取好多矩形框的并集，即所有矩形框的最小外截矩作为目标区域。当然这里也不是只要相交就直接取并集，需要相交的框满足交集占最小框的面积达到一定比例\(也就是阈值\)才合并。  
第三种,也就是本文的NMS，简单的说，对于有相交的就选取其中置信度最高的一个作为最后结果，对于没相交的就直接保留下来，作为最后结果。  
总体来说，3种处理思路都各有千秋，不能一概评论哪种好坏。各种顶会论文也会选择不同的处理方法。

**3.程序实现**

本文提供了nonMaximumSuppression的c语言，c++，M语言，三个版本。  
其中，c语言版本为opencv的源码这里摘出并进行相关的注释。sort为排序函数，这里是最基本的选择排序算法的实现。nonMaximumSuppression为具体非极大值抑制的实现。

