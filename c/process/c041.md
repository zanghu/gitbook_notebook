## 同步工具：pthread

参考资料：APUE 15.6 & 15.9

### 1.介绍

`<pthread.h>`中提供的互斥锁、读写锁和条件变量实际上都可以用于进程间通讯，与多线程模式下的区别是需要将锁或条件变量的属性设置为`PTHREAD_PROCESS_SHARED` 。

此外，为了保证同步工具（锁或条件变量）能够被多个进程共享，应该将同步工具在共享内存上进行初始化。

互斥锁既适用于存在亲缘关系的进程间同步，也适用于不存在亲缘关系的进程之间同步。

`<pthread.h>`中的同步对象不适用于不同位数（32位进程和64位进程之间通讯）的进程间通讯，因为同步工具对象指针、同步工具对象的结构体内存布局在不同位数进程下不同，这本质上是二进制兼容性问题。

### 2.实例

例子使用`mmap`为同步工具分配共享内存，同步工具是互斥锁（`pthread_mutex_t`）和条件变量（`pthread_cond_t`）。

子进程会自动关联父进程已关联的共享内存（mmap、POSIX shm、System V shm），但是`exec`函数会自动解除对父进程所有共享内存的关联。




